### AD queries (requires RSAT)


# Get user information
Get-ADUser <id>
Get-ADUser <id> -Properties *
Get-ADUser <id> | Get-Member
Get-ADUser <id> -Properties Extended | Get-Member

Get-ADUser -Filter 'mail -like "mail@mail.com"'
Get-ADUser -Filter 'Name -like "Baker*"' | Format-Table Name, SamAccountName -AutoSize


# Get user information for one or more users from a file containing email addresses and output in semicolon-delimited format
$filename = "c:\data\accounts.txt"
Get-Content $filename | ForEach-Object {
    $user = Get-ADUser -Filter 'mail -like $_' -Properties LastLogonDate
    $user.Name + ";" + $user.Enabled + ";" + $user.SamAccountName + ";" + $user.LastLogonDate
}




### Splunk queries  https://www.splunk.com/pdfs/solution-guides/splunk-quick-reference-guide.pdf or https://docs.splunk.com/Documentation/Splunk/8.1.0/SearchReference/Stats

index=* "*first.last@company.com*" | stats count by sourcetype
